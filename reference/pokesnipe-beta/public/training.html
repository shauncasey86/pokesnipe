<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PokeSnipe â€” Parser Training</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ§ </text></svg>">

  <!-- Fonts - DM Sans for consistency with dashboard -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,600;9..40,700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="/css/styles.css">
  <style>
    /* Training page navigation buttons */
    .training-nav {
      display: flex;
      gap: var(--space-sm);
    }

    .nav-btn {
      padding: 0.5rem 1rem;
      font-family: var(--font-mono);
      font-size: 12px;
      font-weight: 500;
      color: var(--ink-faded);
      background: transparent;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all 0.2s;
    }

    .nav-btn:hover {
      color: var(--ink);
      border-color: var(--border-strong);
      background: var(--surface-hover);
    }

    .nav-btn.active {
      color: var(--ink);
      background: var(--surface);
      border-color: var(--accent);
    }

    /* Training page specific styles */
    .training-main {
      max-width: 1400px;
      margin: 0 auto;
      padding: var(--space-xl);
    }

    .section { display: none; }
    .section.active { display: block; }

    .section-title {
      font-family: var(--font-display);
      font-size: 24px;
      font-weight: 600;
      margin-bottom: var(--space-lg);
    }

    /* Stats Grid */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--space-lg);
      margin-bottom: var(--space-2xl);
    }

    .stat-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: var(--space-lg);
    }

    .stat-card__label {
      font-family: var(--font-mono);
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--ink-faded);
      margin-bottom: var(--space-sm);
    }

    .stat-card__value {
      font-family: var(--font-mono);
      font-size: 32px;
      font-weight: 600;
      color: var(--ink);
    }

    .stat-card__value.profit { color: var(--profit); }
    .stat-card__value.warning { color: #f59e0b; }
    .stat-card__value.error { color: var(--accent); }

    .stat-card__sub {
      font-size: 12px;
      color: var(--ink-faded);
      margin-top: var(--space-xs);
    }

    /* Analytics Charts */
    .charts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: var(--space-xl);
      margin-bottom: var(--space-2xl);
    }

    .chart-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: var(--space-lg);
    }

    .chart-card__title {
      font-family: var(--font-mono);
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--ink-faded);
      margin-bottom: var(--space-md);
    }

    /* Bar chart */
    .bar-chart {
      display: flex;
      flex-direction: column;
      gap: var(--space-sm);
    }

    .bar-row {
      display: flex;
      align-items: center;
      gap: var(--space-md);
    }

    .bar-label {
      width: 120px;
      font-family: var(--font-mono);
      font-size: 11px;
      color: var(--ink-light);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .bar-track {
      flex: 1;
      height: 20px;
      background: var(--paper-warm);
      border-radius: 3px;
      overflow: hidden;
    }

    .bar-fill {
      height: 100%;
      border-radius: 3px;
      transition: width 0.3s ease;
    }

    .bar-fill.perfect { background: var(--profit); }
    .bar-fill.high { background: #0ea5e9; }
    .bar-fill.medium { background: #f59e0b; }
    .bar-fill.low { background: var(--accent); }
    .bar-fill.pattern { background: #8b5cf6; }

    .bar-value {
      width: 60px;
      text-align: right;
      font-family: var(--font-mono);
      font-size: 12px;
      font-weight: 600;
      color: var(--ink);
    }

    /* Review Section */
    .review-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      margin-bottom: var(--space-lg);
      overflow: hidden;
    }

    .review-card__header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: var(--space-md) var(--space-lg);
      background: var(--paper-warm);
      border-bottom: 1px solid var(--border);
    }

    .review-card__title {
      font-family: var(--font-mono);
      font-size: 13px;
      font-weight: 600;
      color: var(--ink);
    }

    .review-card__badge {
      font-family: var(--font-mono);
      font-size: 10px;
      font-weight: 600;
      padding: 3px 8px;
      border-radius: 3px;
      text-transform: uppercase;
    }

    .review-card__badge.low_confidence { background: rgba(245, 158, 11, 0.15); color: #f59e0b; }
    .review-card__badge.no_scrydex_match { background: rgba(232, 84, 84, 0.15); color: var(--accent); }
    .review-card__badge.user_feedback { background: rgba(139, 92, 246, 0.15); color: #8b5cf6; }
    .review-card__badge.name_mismatch { background: rgba(14, 165, 233, 0.15); color: #0ea5e9; }

    .review-card__body {
      padding: var(--space-lg);
    }

    .review-card__ebay-title {
      font-size: 15px;
      font-weight: 500;
      color: var(--ink);
      margin-bottom: var(--space-md);
      padding: var(--space-md);
      background: var(--paper);
      border-radius: var(--radius);
      border-left: 3px solid var(--profit);
    }

    .parsed-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--space-md);
      margin-bottom: var(--space-lg);
    }

    .parsed-item {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .parsed-item__label {
      font-family: var(--font-mono);
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.03em;
      color: var(--ink-faded);
    }

    .parsed-item__value {
      font-family: var(--font-mono);
      font-size: 14px;
      color: var(--ink);
    }

    .parsed-item__value.empty { color: var(--ink-faded); font-style: italic; }

    .review-card__actions {
      display: flex;
      gap: var(--space-sm);
      padding-top: var(--space-md);
      border-top: 1px solid var(--border);
    }

    .review-btn {
      flex: 1;
      padding: var(--space-sm) var(--space-md);
      font-family: var(--font-mono);
      font-size: 12px;
      font-weight: 600;
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
      transition: all 0.2s;
    }

    .review-btn.correct { background: var(--profit); color: var(--paper); }
    .review-btn.correct:hover { background: #22c55e; }
    .review-btn.incorrect { background: var(--accent); color: var(--paper); }
    .review-btn.incorrect:hover { background: #dc2626; }
    .review-btn.skip { background: var(--paper-warm); color: var(--ink-faded); }
    .review-btn.skip:hover { background: var(--border); color: var(--ink); }

    /* Reason Selection for Incorrect Reviews */
    .review-reasons {
      display: none;
      margin-top: var(--space-md);
      padding: var(--space-md);
      background: var(--paper-warm);
      border-radius: var(--radius);
      animation: fadeIn 0.2s ease;
    }

    .review-reasons.show { display: block; }

    .review-reasons__title {
      font-family: var(--font-mono);
      font-size: 11px;
      font-weight: 600;
      color: var(--ink);
      margin-bottom: var(--space-sm);
      text-align: center;
    }

    .review-reasons__grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: var(--space-xs);
    }

    .reason-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      padding: var(--space-sm);
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--ink-light);
      font-family: var(--font-mono);
      font-size: 10px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .reason-btn:hover {
      background: rgba(232, 84, 84, 0.1);
      border-color: var(--accent);
      color: var(--accent);
    }

    .reason-btn svg { stroke: currentColor; }

    .reason-btn--wide {
      grid-column: span 3;
      flex-direction: row;
      justify-content: center;
    }

    .review-reasons__cancel {
      display: block;
      width: 100%;
      margin-top: var(--space-sm);
      padding: var(--space-xs);
      background: transparent;
      border: none;
      color: var(--ink-faded);
      font-family: var(--font-mono);
      font-size: 10px;
      cursor: pointer;
      text-align: center;
    }

    .review-reasons__cancel:hover { color: var(--ink); }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-4px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .spin {
      animation: spin 1s linear infinite;
    }

    /* Test Section */
    .test-controls {
      display: flex;
      gap: var(--space-md);
      margin-bottom: var(--space-xl);
    }

    .test-results {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      overflow: hidden;
    }

    .test-summary {
      display: flex;
      gap: var(--space-xl);
      padding: var(--space-lg);
      background: var(--paper-warm);
      border-bottom: 1px solid var(--border);
    }

    .test-stat {
      text-align: center;
    }

    .test-stat__value {
      font-family: var(--font-mono);
      font-size: 28px;
      font-weight: 600;
    }

    .test-stat__value.pass { color: var(--profit); }
    .test-stat__value.fail { color: var(--accent); }

    .test-stat__label {
      font-size: 12px;
      color: var(--ink-faded);
    }

    .test-list {
      max-height: 500px;
      overflow-y: auto;
    }

    .test-item {
      display: flex;
      align-items: flex-start;
      gap: var(--space-md);
      padding: var(--space-md) var(--space-lg);
      border-bottom: 1px solid var(--border);
    }

    .test-item:last-child { border-bottom: none; }

    .test-item__icon {
      font-size: 18px;
      flex-shrink: 0;
    }

    .test-item__content {
      flex: 1;
      min-width: 0;
    }

    .test-item__title {
      font-size: 13px;
      color: var(--ink);
      margin-bottom: var(--space-xs);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .test-item__diff {
      font-family: var(--font-mono);
      font-size: 11px;
      color: var(--accent);
    }

    /* Parser Test Tool */
    .parser-test {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: var(--space-lg);
      margin-bottom: var(--space-xl);
    }

    .parser-test__input {
      width: 100%;
      padding: var(--space-md);
      font-family: var(--font-mono);
      font-size: 14px;
      color: var(--ink);
      background: var(--paper);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      margin-bottom: var(--space-md);
    }

    .parser-test__input:focus {
      outline: none;
      border-color: var(--ink-faded);
    }

    .parser-test__output {
      font-family: var(--font-mono);
      font-size: 12px;
      white-space: pre-wrap;
      background: var(--paper);
      padding: var(--space-md);
      border-radius: var(--radius);
      max-height: 400px;
      overflow-y: auto;
    }

    /* Feedback Section */
    .feedback-list {
      display: flex;
      flex-direction: column;
      gap: var(--space-md);
    }

    .feedback-item {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: var(--space-lg);
    }

    .feedback-item__header {
      display: flex;
      justify-content: space-between;
      margin-bottom: var(--space-sm);
    }

    .feedback-item__time {
      font-family: var(--font-mono);
      font-size: 11px;
      color: var(--ink-faded);
    }

    .feedback-item__type {
      font-family: var(--font-mono);
      font-size: 10px;
      font-weight: 600;
      padding: 2px 6px;
      background: rgba(232, 84, 84, 0.15);
      color: var(--accent);
      border-radius: 3px;
      text-transform: uppercase;
    }

    .feedback-item__title {
      font-size: 14px;
      color: var(--ink);
      margin-bottom: var(--space-sm);
    }

    .feedback-item__match {
      font-family: var(--font-mono);
      font-size: 12px;
      color: var(--ink-light);
    }

    /* Empty state */
    .empty-state {
      text-align: center;
      padding: var(--space-3xl);
      color: var(--ink-faded);
    }

    .empty-state__icon { font-size: 48px; margin-bottom: var(--space-md); }
    .empty-state__title { font-size: 18px; color: var(--ink); margin-bottom: var(--space-sm); }

    /* Toast */
    .toast {
      position: fixed;
      bottom: var(--space-xl);
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: var(--surface);
      border: 1px solid var(--profit);
      color: var(--profit);
      padding: var(--space-md) var(--space-xl);
      border-radius: var(--radius);
      font-family: var(--font-mono);
      font-size: 13px;
      box-shadow: var(--shadow-lg);
      transition: transform 0.3s var(--ease-out);
      z-index: 1000;
    }

    .toast.show { transform: translateX(-50%) translateY(0); }
    .toast.error { border-color: var(--accent); color: var(--accent); }

    /* Overview Actions */
    .overview-actions {
      margin-top: var(--space-xl);
      padding: var(--space-lg);
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      text-align: center;
    }

    .overview-actions .btn {
      display: inline-flex;
      align-items: center;
      gap: var(--space-sm);
    }

    .overview-actions__hint {
      margin-top: var(--space-sm);
      font-size: 12px;
      color: var(--ink-faded);
    }

    /* Report Output */
    .report-output {
      margin-top: var(--space-lg);
      background: var(--surface);
      border: 1px solid var(--profit);
      border-radius: var(--radius-lg);
      overflow: hidden;
    }

    .report-output__header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--space-md) var(--space-lg);
      background: var(--profit-light);
      border-bottom: 1px solid var(--profit);
    }

    .report-output__header h3 {
      font-size: 14px;
      font-weight: 600;
      color: var(--profit);
    }

    .report-output__actions {
      display: flex;
      gap: var(--space-sm);
    }

    .report-output__content {
      padding: var(--space-lg);
      font-family: var(--font-mono);
      font-size: 12px;
      line-height: 1.6;
      color: var(--ink-light);
      background: var(--paper-dark);
      max-height: 500px;
      overflow-y: auto;
      white-space: pre-wrap;
      word-break: break-word;
    }

    @media (max-width: 900px) {
      .charts-grid { grid-template-columns: 1fr; }
      .training-nav { flex-wrap: wrap; }
    }
  </style>
</head>
<body class="training-page">
  <!-- Header -->
  <header class="header">
    <div class="header__brand">
      <h1 class="header__logo">PokeSnipe</h1>
      <span class="header__tagline">Training</span>

      <!-- Site Navigation -->
      <nav class="header__nav">
        <a href="/" class="nav-link">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="9"/>
            <rect x="14" y="3" width="7" height="5"/>
            <rect x="14" y="12" width="7" height="9"/>
            <rect x="3" y="16" width="7" height="5"/>
          </svg>
          Dashboard
        </a>
        <a href="/preferences.html" class="nav-link">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"/>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
          </svg>
          Settings
        </a>
        <a href="/training.html" class="nav-link active">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
            <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
          </svg>
          Training
        </a>
      </nav>
    </div>

    <div class="header__controls">
      <button id="theme-toggle" class="btn btn--icon" title="Toggle Theme">
        <svg class="icon-sun" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="5"/>
          <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
        </svg>
        <svg class="icon-moon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        </svg>
      </button>
    </div>
  </header>

  <!-- Page-specific Section Navigation -->
  <div class="training-subnav" style="display: flex; justify-content: center; padding: var(--space-md); background: var(--surface); border-bottom: 1px solid var(--border);">
    <nav class="training-nav">
      <button class="nav-btn active" data-section="overview">Overview</button>
      <button class="nav-btn" data-section="analytics">Analytics</button>
      <button class="nav-btn" data-section="review">Review</button>
      <button class="nav-btn" data-section="test">Test</button>
      <button class="nav-btn" data-section="feedback">Feedback</button>
    </nav>
  </div>

  <!-- Main Content -->
  <main class="training-main">
    <!-- Overview Section -->
    <section id="section-overview" class="section active">
      <h2 class="section-title">Training Overview</h2>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-card__label">Corpus Size</div>
          <div class="stat-card__value" id="stat-total">0</div>
          <div class="stat-card__sub">Total training entries</div>
        </div>
        <div class="stat-card">
          <div class="stat-card__label">Pending Review</div>
          <div class="stat-card__value warning" id="stat-pending">0</div>
          <div class="stat-card__sub">Cases awaiting review</div>
        </div>
        <div class="stat-card">
          <div class="stat-card__label">Verified</div>
          <div class="stat-card__value profit" id="stat-verified">0</div>
          <div class="stat-card__sub">Regression test cases</div>
        </div>
        <div class="stat-card">
          <div class="stat-card__label">Incorrect</div>
          <div class="stat-card__value error" id="stat-incorrect">0</div>
          <div class="stat-card__sub">Known parser failures</div>
        </div>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-card__label">Processed Today</div>
          <div class="stat-card__value" id="stat-processed">0</div>
          <div class="stat-card__sub">Listings parsed</div>
        </div>
        <div class="stat-card">
          <div class="stat-card__label">Match Rate</div>
          <div class="stat-card__value profit" id="stat-match-rate">0%</div>
          <div class="stat-card__sub">Scrydex matches</div>
        </div>
        <div class="stat-card">
          <div class="stat-card__label">Avg Confidence</div>
          <div class="stat-card__value" id="stat-avg-conf">0</div>
          <div class="stat-card__sub">Parser confidence score</div>
        </div>
        <div class="stat-card">
          <div class="stat-card__label">Deals Found</div>
          <div class="stat-card__value profit" id="stat-deals">0</div>
          <div class="stat-card__sub">Profitable matches</div>
        </div>
      </div>

      <!-- Actions -->
      <div class="overview-actions">
        <div style="display: flex; gap: var(--space-md); justify-content: center; flex-wrap: wrap;">
          <button class="btn btn--primary" id="generate-report-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
              <polyline points="14 2 14 8 20 8"/>
              <line x1="16" y1="13" x2="8" y2="13"/>
              <line x1="16" y1="17" x2="8" y2="17"/>
            </svg>
            Generate Report for Claude
          </button>
          <button class="btn btn--secondary" id="clear-corpus-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="3 6 5 6 21 6"/>
              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
            </svg>
            Clear Corpus
          </button>
        </div>
        <p class="overview-actions__hint">
          Generate a report for Claude, then clear the corpus to start fresh training
        </p>
      </div>

      <!-- Report Output (hidden by default) -->
      <div id="report-output" class="report-output" hidden>
        <div class="report-output__header">
          <h3>Parser Improvement Report</h3>
          <div class="report-output__actions">
            <button class="btn btn--small" id="copy-report-btn">Copy to Clipboard</button>
            <button class="btn btn--small btn--secondary" id="close-report-btn">Close</button>
          </div>
        </div>
        <pre class="report-output__content" id="report-content"></pre>
      </div>
    </section>

    <!-- Analytics Section -->
    <section id="section-analytics" class="section">
      <h2 class="section-title">Parser Analytics</h2>

      <div class="charts-grid">
        <div class="chart-card">
          <div class="chart-card__title">Confidence Distribution</div>
          <div class="bar-chart" id="confidence-chart"></div>
        </div>

        <div class="chart-card">
          <div class="chart-card__title">Top Pattern Matches</div>
          <div class="bar-chart" id="patterns-chart"></div>
        </div>

        <div class="chart-card">
          <div class="chart-card__title">Skip Reasons</div>
          <div class="bar-chart" id="skip-chart"></div>
        </div>

        <div class="chart-card">
          <div class="chart-card__title">Capture Reasons</div>
          <div class="bar-chart" id="capture-chart"></div>
        </div>
      </div>
    </section>

    <!-- Review Section -->
    <section id="section-review" class="section">
      <h2 class="section-title">Review Pending Cases</h2>
      <p style="color: var(--ink-faded); margin-bottom: var(--space-lg);">
        Review edge cases captured during scans. Mark as correct to add to regression tests.
      </p>
      <div id="review-list"></div>
    </section>

    <!-- Test Section -->
    <section id="section-test" class="section">
      <h2 class="section-title">Parser Testing</h2>

      <div class="parser-test">
        <div class="chart-card__title" style="margin-bottom: var(--space-sm);">Test Parser</div>
        <input type="text" id="parser-input" class="parser-test__input" placeholder="Paste eBay title here to test parser...">
        <div class="parser-test__output" id="parser-output">Enter a title above to see parser output</div>
      </div>

      <!-- eBay Listing Test -->
      <div class="parser-test" id="ebay-listing-test">
        <div class="chart-card__title" style="margin-bottom: var(--space-sm);">
          eBay Listing Test
          <span style="font-weight: 400; color: var(--ink-faded);"> â€” Fetch live listing data from eBay API</span>
        </div>
        <div style="display: flex; gap: var(--space-sm); margin-bottom: var(--space-md);">
          <input type="text" id="ebay-url-input" class="parser-test__input" style="margin-bottom: 0; flex: 1;" placeholder="Paste eBay URL or item ID here...">
          <button class="btn btn--primary" id="fetch-listing-btn" style="white-space: nowrap;">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 4px;">
              <polyline points="1 4 1 10 7 10"/>
              <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/>
            </svg>
            Fetch
          </button>
        </div>

        <!-- Listing Result -->
        <div id="ebay-listing-result" style="display: none;">
          <!-- Listing Header with Image -->
          <div id="listing-header" style="display: flex; gap: var(--space-lg); margin-bottom: var(--space-lg); padding: var(--space-md); background: var(--paper-warm); border-radius: var(--radius); border-left: 3px solid var(--accent);">
            <img id="listing-image" src="" alt="" style="width: 120px; height: 120px; object-fit: contain; background: var(--paper); border-radius: var(--radius-sm); border: 1px solid var(--border);">
            <div style="flex: 1; min-width: 0;">
              <div id="listing-title" style="font-size: 15px; font-weight: 500; color: var(--ink); margin-bottom: var(--space-sm);"></div>
              <div style="display: flex; flex-wrap: wrap; gap: var(--space-md); font-family: var(--font-mono); font-size: 12px;">
                <span id="listing-price" style="color: var(--profit); font-weight: 600;"></span>
                <span id="listing-shipping" style="color: var(--ink-faded);"></span>
                <span id="listing-condition" style="color: var(--ink-light);"></span>
                <span id="listing-seller" style="color: var(--ink-faded);"></span>
              </div>
              <div style="margin-top: var(--space-sm);">
                <a id="listing-link" href="#" target="_blank" rel="noopener" style="font-size: 12px; color: var(--accent);">View on eBay â†’</a>
              </div>
            </div>
          </div>

          <!-- Two Column Layout -->
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg);">
            <!-- Listing Data Column -->
            <div>
              <div class="chart-card__title" style="margin-bottom: var(--space-sm);">Listing Data (from eBay API)</div>
              <div class="parser-test__output" id="listing-data-output" style="max-height: 350px;"></div>
            </div>

            <!-- Parser Output Column -->
            <div>
              <div class="chart-card__title" style="margin-bottom: var(--space-sm);">Parser Output</div>
              <div class="parser-test__output" id="listing-parser-output" style="max-height: 350px;"></div>
            </div>
          </div>

          <!-- Copy JSON Button -->
          <div style="margin-top: var(--space-md); text-align: right;">
            <button class="btn btn--small" id="copy-listing-json-btn">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 4px;">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
              </svg>
              Copy Full JSON
            </button>
          </div>
        </div>

        <!-- Initial State / Error State -->
        <div id="ebay-listing-placeholder" style="padding: var(--space-lg); text-align: center; color: var(--ink-faded); background: var(--paper); border-radius: var(--radius);">
          Enter an eBay URL or item ID above to fetch listing data
        </div>
      </div>

      <div class="test-controls">
        <button class="btn btn--primary" id="run-tests-btn">Run Regression Tests</button>
        <button class="btn" id="export-btn">Export Corpus</button>
      </div>

      <div class="test-results" id="test-results" style="display: none;">
        <div class="test-summary" id="test-summary"></div>
        <div class="test-list" id="test-list"></div>
      </div>
    </section>

    <!-- Feedback Section -->
    <section id="section-feedback" class="section">
      <h2 class="section-title">User Feedback</h2>
      <p style="color: var(--ink-faded); margin-bottom: var(--space-lg);">
        Wrong match reports from users. Use these to identify parser issues.
      </p>
      <div id="feedback-list" class="feedback-list"></div>
    </section>
  </main>

  <!-- Toast -->
  <div class="toast" id="toast">Saved!</div>

  <script src="/js/training.js"></script>
</body>
</html>
